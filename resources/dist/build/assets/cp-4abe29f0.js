function c(s,t,e,r,a,l,d,h){var i=typeof s=="function"?s.options:s;t&&(i.render=t,i.staticRenderFns=e,i._compiled=!0),r&&(i.functional=!0),l&&(i._scopeId="data-v-"+l);var o;if(d?(o=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__<"u"&&(n=__VUE_SSR_CONTEXT__),a&&a.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(d)},i._ssrRegister=o):a&&(o=h?function(){a.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:a),o)if(i.functional){i._injectStyles=o;var m=i.render;i.render=function(g,f){return o.call(f),m(g,f)}}else{var p=i.beforeCreate;i.beforeCreate=p?[].concat(p,o):[o]}return{exports:s,options:i}}const v={mixins:[Fieldtype],computed:{fields(){return _.chain(this.meta.fields).map(s=>({handle:s.handle,...s.field})).values().value()}},methods:{updateKey(s,t){let e=this.value;Vue.set(e,s,t),this.update(e)}}};var C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"publish-fields"},t._l(t.fields,function(r){return e("publish-field",{key:r.handle,staticClass:"form-group",attrs:{config:r,value:t.value[r.handle],meta:t.meta.meta[r.handle],"read-only":!r.localizable},on:{"meta-updated":function(a){return t.metaUpdated(r.handle,a)},focus:function(a){return t.$emit("focus")},blur:function(a){return t.$emit("blur")},input:function(a){return t.updateKey(r.handle,a)}}})}),1)},b=[],x=c(v,C,b,!1,null,null,null,null);const y=x.exports;const $={mixins:[Fieldtype],data(){return{autoBindChangeWatcher:!1,changeWatcherWatchDeep:!1,allowedFieldtypes:[]}},computed:{source(){return this.value.source},sourceField(){return this.value.source==="field"?this.value.value:null},componentName(){return this.config.field.type.replace(".","-")+"-fieldtype"},sourceTypeSelectOptions(){let s=[];return this.config.field!==!1&&s.push({label:__("seo-pro::messages.custom"),value:"custom"}),this.config.from_field!==!1&&s.unshift({label:__("seo-pro::messages.from_field"),value:"field"}),this.config.inherit!==!1&&s.unshift({label:__("seo-pro::messages.inherit"),value:"inherit"}),this.config.disableable&&s.push({label:__("seo-pro::messages.disable"),value:"disable"}),s},fieldConfig(){return Object.assign(this.config.field,{placeholder:this.config.placeholder})},placeholder(){return this.config.placeholder}},mounted(){let s=this.config.allowed_fieldtypes||["text","textarea","markdown","redactor"];this.allowedFieldtypes=s.concat(this.config.merge_allowed_fieldtypes||[])},methods:{sourceDropdownChanged(s){this.value.source=s,s!=="field"&&(this.value.value=this.meta.defaultValue,this.meta.fieldMeta=this.meta.defaultFieldMeta)},sourceFieldChanged(s){this.value.value=s},customValueChanged(s){let t=this.value;t.value=s,this.update(t)}}};var w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex"},[e("div",{staticClass:"source-type-select pr-4"},[e("v-select",{attrs:{options:t.sourceTypeSelectOptions,reduce:r=>r.value,disabled:!t.config.localizable,clearable:!1,value:t.source},on:{input:t.sourceDropdownChanged}})],1),e("div",{staticClass:"flex-1"},[t.source==="inherit"?e("div",{staticClass:"text-sm text-grey inherit-placeholder mt-1"},[t.placeholder!==!1?[t._v(" "+t._s(t.placeholder)+" ")]:t._e()],2):t.source==="field"?e("div",{staticClass:"source-field-select"},[e("text-input",{attrs:{value:t.sourceField,disabled:!t.config.localizable},on:{input:t.sourceFieldChanged}})],1):t.source==="custom"?e(t.componentName,{tag:"component",attrs:{name:t.name,config:t.fieldConfig,value:t.value.value,meta:t.meta.fieldMeta,"read-only":!t.config.localizable,handle:"source_value"},on:{input:t.customValueChanged}}):t._e()],1)])},S=[],R=c($,w,S,!1,null,null,null,null);const F=R.exports,k={props:["status"]};var P=function(){var t=this,e=t._self._c;return e("div",[t.status==="pending"?e("span",{staticClass:"icon icon-circular-graph animation-spin"}):e("span",{staticClass:"little-dot",class:{"bg-green-600":t.status==="pass","bg-red-500":t.status==="fail","bg-orange":t.status==="warning"}})])},T=[],V=c(k,P,T,!1,null,null,null,null);const u=V.exports,D={props:["id","initialStatus","initialScore"],data(){return{status:this.initialStatus,score:this.initialScore}},created(){this.score||this.updateScore()},methods:{updateScore(){Statamic.$request.get(cp_url(`seo-pro/reports/${this.id}`)).then(s=>{if(s.data.status==="pending"||s.data.status==="generating"){setTimeout(()=>this.updateScore(),1e3);return}this.status=s.data.status,this.score=s.data.score})}}};var z=function(){var t=this,e=t._self._c;return e("div",[t.score?e("div",[e("seo-pro-status-icon",{staticClass:"inline-block ml-1 mr-3",attrs:{status:t.status}}),t._v(" "+t._s(t.score)+"% ")],1):e("loading-graphic",{attrs:{text:null,inline:!0}})],1)},M=[],N=c(D,z,M,!1,null,null,null,null);const O=N.exports,H={props:["item"],components:{StatusIcon:u}};var W=function(){var t=this,e=t._self._c;return e("modal",{attrs:{name:"report-details","click-to-close":!0},on:{closed:function(r){return t.$emit("closed")}}},[e("div",{staticClass:"p-0"},[e("h1",{staticClass:"p-4 bg-gray-200 border-b text-lg"},[t._v(" "+t._s(t.__("seo-pro::messages.page_details"))+" ")]),e("div",{staticClass:"modal-body"},t._l(t.item.results,function(r){return e("div",{staticClass:"flex px-4 leading-normal pb-2",class:{"bg-red-100":r.status!=="pass"}},[e("status-icon",{staticClass:"mr-3 mt-2",attrs:{status:r.status}}),e("div",{staticClass:"flex-1 mt-2 prose text-gray-700"},[e("div",{staticClass:"text-gray-900",domProps:{innerHTML:t._s(r.description)}}),r.comment?e("div",{staticClass:"text-xs",class:{"text-red-800":r.status!=="pass"},domProps:{innerHTML:t._s(r.comment)}}):t._e()])],1)}),0),e("footer",{staticClass:"px-5 py-3 bg-gray-200 rounded-b-lg border-t flex items-center font-mono text-xs"},[e("a",{staticClass:"font-normal text-gray-700 hover:text-gray-800 mr-4",attrs:{href:t.item.url,target:"_blank"},domProps:{textContent:t._s(t.item.url)}})])])])},q=[],L=c(H,W,q,!1,null,null,null,null);const U=L.exports,G={props:["date"],data(){return{text:null}},mounted(){this.update()},methods:{update(){this.text=moment(this.date*1e3).fromNow(),setTimeout(()=>this.update(),6e4)}}};var I=function(){var t=this,e=t._self._c;return e("span",[t._v(t._s(t.text))])},K=[],X=c(G,I,K,!1,null,null,null,null);const j=X.exports,B={components:{PageDetails:U,RelativeDate:j,StatusIcon:u},props:["initialReport"],data(){return{loading:!1,report:this.initialReport,selected:null}},computed:{isGenerating(){return this.initialReport.status==="pending"||this.initialReport.status==="generating"},id(){return this.report.id},isCachedHeaderReady(){return this.report.date&&this.report.pages_crawled&&this.report.score},sortablePages(){return this.report.pages.map(s=>(s.status_raw=s.status,s.status==="fail"&&(s.status="1fail"),s.status==="warning"&&(s.status="2warning"),s.status==="pass"&&(s.status="3pass"),s))}},mounted(){this.load()},methods:{load(){this.loading=!0,Statamic.$request.get(cp_url(`seo-pro/reports/${this.id}`)).then(s=>{if(s.data.status==="pending"||s.data.status==="generating"){setTimeout(()=>this.load(),1e3);return}this.report=s.data,this.loading=!1})},actionablePageResults(s){return _.chain(s.results).reject(t=>t.status==="pass").map(t=>t.actionable_pill).unique().value()}}};var E=function(){var t=this,e=t._self._c;return e("div",[e("header",{staticClass:"flex items-center mb-6"},[e("h1",{staticClass:"flex-1"},[t._v(t._s(t.__("seo-pro::messages.seo_report")))]),t.loading?t._e():e("a",{staticClass:"btn-primary",attrs:{href:t.cp_url("seo-pro/reports/create")}},[t._v(t._s(t.__("seo-pro::messages.generate_report")))])]),t.report?e("div",[t.isCachedHeaderReady?e("div",[e("h3",{staticClass:"little-heading rtl:pr-0 ltr:pl-0 mt-4 mb-2"},[t._v(t._s(t.__("Summary")))]),e("div",{staticClass:"card p-0 mt-2"},[e("div",{staticClass:"p-4 border-b dark:border-dark-900"},[e("div",{staticClass:"w-full flex"},[e("div",[e("h2",{staticClass:"text-sm text-gray-700"},[t._v(t._s(t.__("seo-pro::messages.generated")))]),e("div",{staticClass:"text-lg"},[e("relative-date",{attrs:{date:t.report.date}})],1)]),e("div",{staticClass:"grow text-right mr-8"},[e("h2",{staticClass:"text-sm text-gray-700"},[t._v(t._s(t.__("Pages Crawled")))]),e("div",{staticClass:"text-lg"},[t._v(t._s(t.report.pages_crawled))])]),e("div",{staticClass:"text-right"},[e("h2",{staticClass:"text-sm text-gray-700"},[t._v(t._s(t.__("Site Score")))]),e("div",{staticClass:"text-lg",class:{"text-red-500":t.report.score<70,"text-orange":t.report.score<90,"text-green-600":t.report.score>=90}},[t._v(t._s(t.report.score)+"%")])])]),e("div",{staticClass:"bg-gray-300 h-4 w-full rounded mr-2 mt-4"},[e("div",{staticClass:"h-4 rounded-l",class:{"bg-red-500":t.report.score<70,"bg-orange":t.report.score<90,"bg-green-600":t.report.score>=90},style:`width: ${t.report.score}%`})])]),e("table",{staticClass:"data-table"},[e("tbody",t._l(t.report.results,function(r){return e("tr",[e("td",{staticClass:"w-8 text-center"},[e("status-icon",{attrs:{status:r.status}})],1),e("td",{staticClass:"p-0"},[t._v(t._s(r.description))]),e("td",{staticClass:"text-right"},[t._v(t._s(r.comment))])])}),0)])])]):t._e(),t.loading&&t.isGenerating?e("div",{staticClass:"card loading"},[e("loading-graphic",{attrs:{text:t.__("seo-pro::messages.report_is_being_generated")}})],1):e("div",[e("h3",{staticClass:"little-heading rtl:pr-0 ltr:pl-0 mt-4 mb-2"},[t._v(t._s(t.__("seo-pro::messages.page_details")))]),t.loading?e("div",{staticClass:"card loading"},[e("loading-graphic")],1):e("data-list",{ref:"dataList",attrs:{columns:t.report.columns,rows:t.report.pages},scopedSlots:t._u([{key:"default",fn:function({filteredRows:r}){return e("div",{staticClass:"card overflow-hidden p-0"},[e("data-list-table",{attrs:{rows:t.sortablePages},scopedSlots:t._u([{key:"cell-status",fn:function({row:a}){return[e("status-icon",{staticClass:"inline-block w-5",attrs:{status:a.status_raw}}),t._v(" "+t._s(t.__("seo-pro::messages.rules."+a.status_raw))+" ")]}},{key:"cell-page",fn:function({row:a}){return[e("a",{attrs:{href:a.edit_url,target:"_blank"},domProps:{textContent:t._s(a.url)}})]}},{key:"cell-actionable",fn:function({row:a}){return[t.selected===a.id?e("page-details",{attrs:{item:a},on:{closed:function(l){t.selected=null}}}):t._e(),e("a",{staticClass:"flex",staticStyle:{gap:"0.25rem"},on:{click:function(l){l.preventDefault(),t.selected=a.id}}},t._l(t.actionablePageResults(a),function(l){return e("span",{key:a.id+"_actionable_pill_"+l,staticClass:"inline-block text-xs bg-gray-300 hover:bg-gray-800 text-gray-800 shrink rounded-full px-2 py-0.5 text-center justify-center",staticStyle:{"padding-top":"2px","padding-bottom":"2px"}},[t._v(t._s(l))])}),0)]}},{key:"actions",fn:function({row:a}){return e("td",{staticClass:"text-right text-xs p-0 whitespace-no-wrap"},[a.url?e("a",{staticClass:"font-normal text-gray-700 hover:text-gray-800",attrs:{href:a.url,target:"_blank"},domProps:{textContent:t._s(t.__("Visit"))}}):t._e()])}}],null,!0)})],1)}}],null,!1,4210847518)})],1)]):t._e()])},A=[],J=c(B,E,A,!1,null,null,null,null);const Q=J.exports;Statamic.$components.register("seo_pro-fieldtype",y);Statamic.$components.register("seo_pro_source-fieldtype",F);Statamic.$components.register("seo-pro-status-icon",u);Statamic.$components.register("seo-pro-report",Q);Statamic.$components.register("seo-pro-index-score",O);
