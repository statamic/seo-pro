function d(a,t,e,r,s,n,u,g){var i=typeof a=="function"?a.options:a;t&&(i.render=t,i.staticRenderFns=e,i._compiled=!0),r&&(i.functional=!0),n&&(i._scopeId="data-v-"+n);var l;if(u?(l=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),s&&s.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(u)},i._ssrRegister=l):s&&(l=g?function(){s.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(i.functional){i._injectStyles=l;var h=i.render;i.render=function(f,m){return l.call(m),h(f,m)}}else{var p=i.beforeCreate;i.beforeCreate=p?[].concat(p,l):[l]}return{exports:a,options:i}}const v={mixins:[Fieldtype],inject:["storeName"],computed:{fields(){return _.chain(this.meta.fields).map(a=>({handle:a.handle,...a.field})).values().value()}},methods:{updateKey(a,t){let e=this.value;Vue.set(e,a,t),this.update(e)},metaUpdated(a,t){this.$emit("meta-updated",{...this.meta,meta:{...this.meta.meta,[a]:t}})},errors(a){const t=this.$store.state.publish[this.storeName];return t?t.errors["seo."+a]||[]:[]}}};var x=function(){var t=this,e=t._self._c;return e("div",{staticClass:"publish-fields"},t._l(t.fields,function(r){return e("publish-field",{key:r.handle,staticClass:"form-group",attrs:{config:r,value:t.value[r.handle],meta:t.meta.meta[r.handle],"read-only":!r.localizable,errors:t.errors(r.handle)},on:{"meta-updated":function(s){return t.metaUpdated(r.handle,s)},focus:function(s){return t.$emit("focus")},blur:function(s){return t.$emit("blur")},input:function(s){return t.updateKey(r.handle,s)}}})}),1)},C=[],b=d(v,x,C,!1,null,null,null,null);const y=b.exports;const k={mixins:[Fieldtype],data(){return{autoBindChangeWatcher:!1,changeWatcherWatchDeep:!1,allowedFieldtypes:[]}},computed:{source(){return this.value.source},sourceField(){return this.value.source==="field"?this.value.value:null},componentName(){return this.config.field.type.replace(".","-")+"-fieldtype"},sourceTypeSelectOptions(){let a=[];return this.config.field!==!1&&a.push({label:__("seo-pro::messages.custom"),value:"custom"}),this.config.from_field!==!1&&a.unshift({label:__("seo-pro::messages.from_field"),value:"field"}),this.config.inherit!==!1&&a.unshift({label:__("seo-pro::messages.inherit"),value:"inherit"}),this.config.disableable&&a.push({label:__("seo-pro::messages.disable"),value:"disable"}),a},fieldConfig(){return Object.assign(this.config.field,{placeholder:this.config.placeholder})},placeholder(){return this.config.placeholder}},mounted(){let a=this.config.allowed_fieldtypes||["text","textarea","markdown","redactor"];this.allowedFieldtypes=a.concat(this.config.merge_allowed_fieldtypes||[])},methods:{sourceDropdownChanged(a){let t=this.value;t.source=a,a!=="field"&&(t.value=this.meta.defaultValue,this.$emit("meta-updated",{...this.meta,fieldMeta:this.meta.defaultFieldMeta})),this.update(t)},sourceFieldChanged(a){this.update({...this.value,value:a})},customValueChanged(a){this.update({...this.value,value:a})}}};var w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex"},[e("div",{staticClass:"source-type-select pr-4"},[e("v-select",{attrs:{options:t.sourceTypeSelectOptions,reduce:r=>r.value,disabled:!t.config.localizable,clearable:!1,value:t.source},on:{input:t.sourceDropdownChanged}})],1),e("div",{staticClass:"flex-1"},[t.source==="inherit"?e("div",{staticClass:"text-sm text-grey inherit-placeholder mt-1"},[t.placeholder!==!1?[t._v(" "+t._s(t.placeholder)+" ")]:t._e()],2):t.source==="field"?e("div",{staticClass:"source-field-select"},[e("text-input",{attrs:{value:t.sourceField,disabled:!t.config.localizable},on:{input:t.sourceFieldChanged}})],1):t.source==="custom"?e(t.componentName,{tag:"component",attrs:{name:t.name,config:t.fieldConfig,value:t.value.value,meta:t.meta.fieldMeta,"read-only":!t.config.localizable,handle:"source_value"},on:{input:t.customValueChanged}}):t._e()],1)])},$=[],P=d(k,w,$,!1,null,null,null,null);const S=P.exports,R={props:["status"]};var F=function(){var t=this,e=t._self._c;return e("div",[t.status==="pending"?e("span",{staticClass:"icon icon-circular-graph animation-spin"}):e("span",{staticClass:"little-dot",class:{"bg-green-600":t.status==="pass","bg-red-500":t.status==="fail","bg-orange":t.status==="warning"}})])},T=[],D=d(R,F,T,!1,null,null,null,null);const c=D.exports,I={props:["id","initialStatus","initialScore"],data(){return{status:this.initialStatus,score:this.initialScore}},computed:{statusByScore(){if(!this.score)return this.status;if(this.score<70)return"fail";if(this.score<90)return"warning";if(this.score>=90)return"pass"}},created(){this.score||this.updateScore()},methods:{updateScore(){Statamic.$request.get(cp_url(`seo-pro/reports/${this.id}`)).then(a=>{if(a.data.status==="pending"||a.data.status==="generating"){setTimeout(()=>this.updateScore(),1e3);return}this.status=a.data.status,this.score=a.data.score})}}};var O=function(){var t=this,e=t._self._c;return e("div",[t.score?e("div",[e("seo-pro-status-icon",{staticClass:"inline-block ml-1 mr-3",attrs:{status:t.statusByScore}}),t._v(" "+t._s(t.score)+"% ")],1):e("loading-graphic",{attrs:{text:null,inline:!0}})],1)},N=[],V=d(I,O,N,!1,null,null,null,null);const M=V.exports,E={props:["item"],components:{StatusIcon:c}};var L=function(){var t=this,e=t._self._c;return e("modal",{attrs:{name:"report-details","click-to-close":!0},on:{closed:function(r){return t.$emit("closed")}}},[e("div",{staticClass:"p-0"},[e("h1",{staticClass:"p-4 bg-gray-200 dark:bg-dark-650 border-b dark:border-dark-900 text-lg"},[t._v(" "+t._s(t.__("seo-pro::messages.page_details"))+" ")]),e("div",{staticClass:"modal-body"},[t._l(t.item.results,function(r){return e("div",{staticClass:"flex px-4 leading-normal pb-2",class:{"bg-red-100 dark:bg-dark-400":r.status!=="pass"}},[e("status-icon",{staticClass:"mr-3 mt-2",attrs:{status:r.status}}),e("div",{staticClass:"flex-1 mt-2 prose text-gray-700 dark:text-dark-150"},[e("div",{staticClass:"text-gray-900 dark:text-dark-100",domProps:{innerHTML:t._s(r.description)}}),r.comment?e("div",{staticClass:"text-xs",class:{"text-red-800 dark:text-dark-150":r.status!=="pass"},domProps:{innerHTML:t._s(r.comment)}}):t._e()])],1)}),t.item.metadata?e("div",{staticClass:"mt-4 px-4 pb-4"},[e("h3",{staticClass:"text-sm font-bold text-gray-900 dark:text-dark-100 mb-2"},[t._v("SEO Metadata Summary")]),e("div",{staticClass:"space-y-1 text-xs"},[t.item.metadata.published_date?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("Published:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100"},[t._v(t._s(t.item.metadata.published_date))])]):t._e(),t.item.metadata.updated_date?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("Updated:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100"},[t._v(t._s(t.item.metadata.updated_date))])]):t._e(),t.item.metadata.author?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("Author:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100"},[t._v(t._s(t.item.metadata.author))])]):t._e(),t.item.metadata.og_type?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("OG Type:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100"},[t._v(t._s(t.item.metadata.og_type))])]):t._e(),t.item.metadata.og_description?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("OG Description:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100 truncate"},[t._v(t._s(t.item.metadata.og_description))])]):t._e(),t.item.metadata.og_image?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("OG Image:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100"},[t._v("✓")])]):t._e(),t.item.metadata.twitter_card?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("Twitter Card:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100"},[t._v(t._s(t.item.metadata.twitter_card))])]):t._e(),t.item.metadata.twitter_title?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("Twitter Title:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100 truncate"},[t._v(t._s(t.item.metadata.twitter_title))])]):t._e(),t.item.metadata.twitter_description?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("Twitter Desc:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100 truncate"},[t._v(t._s(t.item.metadata.twitter_description))])]):t._e(),t.item.metadata.twitter_image?e("div",{staticClass:"flex"},[e("span",{staticClass:"font-semibold w-32 text-gray-700 dark:text-dark-150"},[t._v("Twitter Image:")]),e("span",{staticClass:"text-gray-900 dark:text-dark-100"},[t._v("✓")])]):t._e()])]):t._e()],2),e("footer",{staticClass:"px-4 py-3 dark:bg-dark-700 dark:border-dark-900 rounded-b-lg border-t flex items-center text-sm flex"},[t.item.url?e("a",{staticClass:"font-normal font-mono text-xs text-gray-700 hover:text-blue grow truncate",attrs:{href:t.item.url,target:"_blank"},domProps:{textContent:t._s(t.item.url)}}):t._e(),t.item.url?e("a",{staticClass:"font-normal text-gray-700 hover:text-blue ml-8",attrs:{href:t.item.url,target:"_blank"},domProps:{textContent:t._s(t.__("Visit"))}}):t._e(),t.item.edit_url?e("a",{staticClass:"font-normal text-gray-700 hover:text-blue ml-4",attrs:{href:t.item.edit_url,target:"_blank"},domProps:{textContent:t._s(t.__("Edit"))}}):t._e()])])])},U=[],z=d(E,L,U,!1,null,null,null,null);const G=z.exports,H={props:["date"],data(){return{text:null}},mounted(){this.update()},methods:{update(){this.text=moment(this.date*1e3).fromNow(),setTimeout(()=>this.update(),6e4)}}};var W=function(){var t=this,e=t._self._c;return e("span",[t._v(t._s(t.text))])},A=[],B=d(H,W,A,!1,null,null,null,null);const j=B.exports,q={components:{PageDetails:G,RelativeDate:j,StatusIcon:c},props:["initialReport","initialPage","initialPerPage"],data(){return{loading:!0,report:this.initialReport,selectedId:null,sortColumn:"status",sortDirection:"asc",page:this.initialPage,perPage:this.initialPerPage,paginationMeta:{}}},computed:{isGenerating(){return this.initialReport.status==="pending"||this.initialReport.status==="generating"},id(){return this.report.id},isCachedHeaderReady(){return this.report.date&&this.report.pages_crawled&&this.report.score},sortablePages(){return this.loading?[]:this.report.pages.data},parameters(){return{sortColumn:this.sortColumn,sortDirection:this.sortDirection,page:this.page,perPage:this.perPage}}},watch:{parameters:{deep:!0,handler(a,t){JSON.stringify(t)!==JSON.stringify(a)&&(this.load(),this.pushState())}}},mounted(){window.history.replaceState({parameters:this.parameters},""),window.addEventListener("popstate",this.popState)},beforeDestroy(){window.removeEventListener("popstate",this.popState)},created(){this.load()},methods:{load(){this.$axios.get(cp_url(`seo-pro/reports/${this.id}/pages`),{params:this.parameters}).then(a=>{if(a.data.status==="pending"||a.data.status==="generating"){setTimeout(()=>this.load(),1e3);return}this.report=a.data,this.sortColumn=a.data.sortColumn,this.sortDirection=a.data.sortDirection,this.page=a.data.pages.current_page,this.perPage=a.data.pages.per_page,this.paginationMeta=a.data.pages,this.loading=!1})},actionablePageResults(a){return _.chain(a.results).reject(t=>t.status==="pass").map(t=>t.actionable_pill).unique().value()},selectPaginationPage(a){this.page=parseInt(a)},selectPaginationPerPage(a){this.perPage=parseInt(a)},sorted(a,t){this.sortColumn=a,this.sortDirection=t},popState(a){a.state&&(this.popping=!0,this.page=a.state.parameters.page,this.perPage=a.state.parameters.perPage,this.$nextTick(()=>{this.popping=!1}))},pushState(){if(this.popping)return;const a=this.parameters,t=new URLSearchParams(a);window.history.pushState({parameters:a},"","?"+t.toString())}}};var J=function(){var t=this,e=t._self._c;return e("div",[e("header",{staticClass:"flex items-center mb-6"},[e("h1",{staticClass:"flex-1"},[t._v(t._s(t.__("seo-pro::messages.seo_report")))]),t.loading?t._e():e("a",{staticClass:"btn-primary",attrs:{href:t.cp_url("seo-pro/reports/create")}},[t._v(t._s(t.__("seo-pro::messages.generate_report")))])]),t.report?e("div",[t.isCachedHeaderReady?e("div",[e("h3",{staticClass:"little-heading rtl:pr-0 ltr:pl-0 mt-4 mb-2"},[t._v(t._s(t.__("Summary")))]),e("div",{staticClass:"card p-0 mt-2"},[e("div",{staticClass:"p-4 border-b dark:border-dark-900"},[e("div",{staticClass:"w-full flex"},[e("div",[e("h2",{staticClass:"text-sm text-gray-700"},[t._v(t._s(t.__("seo-pro::messages.generated")))]),e("div",{staticClass:"text-lg"},[e("relative-date",{attrs:{date:t.report.date}})],1)]),e("div",{staticClass:"grow text-right mr-8"},[e("h2",{staticClass:"text-sm text-gray-700"},[t._v(t._s(t.__("Actionable Pages")))]),e("div",{staticClass:"text-lg"},[t._v(t._s(t.report.pages_actionable||"N/A"))])]),e("div",{staticClass:"text-right mr-8"},[e("h2",{staticClass:"text-sm text-gray-700"},[t._v(t._s(t.__("Total Pages Crawled")))]),e("div",{staticClass:"text-lg"},[t._v(t._s(t.report.pages_crawled))])]),e("div",{staticClass:"text-right"},[e("h2",{staticClass:"text-sm text-gray-700"},[t._v(t._s(t.__("Site Score")))]),e("div",{staticClass:"text-lg",class:{"text-red-500":t.report.score<70,"text-orange":t.report.score<90,"text-green-600":t.report.score>=90}},[t._v(t._s(t.report.score)+"%")])])]),e("div",{staticClass:"bg-gray-300 dark:bg-dark-650 h-4 w-full rounded mr-2 mt-4"},[e("div",{staticClass:"h-4 rounded-l",class:{"bg-red-500":t.report.score<70,"bg-orange":t.report.score<90,"bg-green-600":t.report.score>=90},style:`width: ${t.report.score}%`})])]),e("table",{staticClass:"data-table"},[e("tbody",t._l(t.report.results,function(r){return e("tr",[e("td",{staticClass:"w-8 text-center"},[e("status-icon",{attrs:{status:r.status}})],1),e("td",{staticClass:"p-0"},[t._v(t._s(r.description))]),e("td",{staticClass:"text-right"},[t._v(t._s(r.comment))])])}),0)])])]):t._e(),t.loading&&t.isGenerating?e("div",{staticClass:"card loading"},[e("loading-graphic",{attrs:{text:t.__("seo-pro::messages.report_is_being_generated")}})],1):e("div",[e("h3",{staticClass:"little-heading rtl:pr-0 ltr:pl-0 mt-4 mb-2"},[t._v(t._s(t.__("seo-pro::messages.page_details")))]),t.loading?e("div",{staticClass:"card loading"},[e("loading-graphic")],1):e("data-list",{ref:"dataList",attrs:{columns:t.report.columns,rows:t.sortablePages,sort:!1,"sort-column":t.sortColumn,"sort-direction":t.sortDirection},scopedSlots:t._u([{key:"default",fn:function({filteredRows:r}){return e("div",{},[e("div",{staticClass:"card overflow-hidden p-0"},[e("data-list-table",{attrs:{rows:t.sortablePages},on:{sorted:t.sorted},scopedSlots:t._u([{key:"cell-status",fn:function({row:s}){return[e("status-icon",{staticClass:"inline-block w-5",attrs:{status:s.status}}),t._v(" "+t._s(t.__("seo-pro::messages.rules."+s.status))+" ")]}},{key:"cell-url",fn:function({row:s}){return[e("a",{staticClass:"hover:text-black dark:hover:text-dark-100",domProps:{textContent:t._s(s.url)},on:{click:function(n){n.preventDefault(),t.selectedId=s.id}}})]}},{key:"cell-actionable",fn:function({row:s}){return[t.selectedId===s.id?e("page-details",{attrs:{item:s},on:{closed:function(n){t.selectedId=null}}}):t._e(),e("a",{staticClass:"flex",staticStyle:{gap:"0.25rem"},on:{click:function(n){n.preventDefault(),t.selectedId=s.id}}},t._l(t.actionablePageResults(s),function(n){return e("span",{key:s.id+"_actionable_pill_"+n,staticClass:"inline-block text-xs bg-gray-300 dark:bg-dark-200 hover:bg-gray-800 text-gray-800 dark:text-dark-100 shrink rounded-full px-2 py-0.5 text-center justify-center",staticStyle:{"padding-top":"2px","padding-bottom":"2px"}},[t._v(t._s(n))])}),0)]}},{key:"actions",fn:function({row:s}){return e("td",{staticClass:"text-right text-xs p-0 whitespace-no-wrap"},[s.url?e("a",{staticClass:"font-normal text-gray-700 hover:text-blue",attrs:{href:s.url,target:"_blank"},domProps:{textContent:t._s(t.__("Visit"))}}):t._e(),s.edit_url?e("a",{staticClass:"font-normal text-gray-700 hover:text-blue ml-4",attrs:{href:s.edit_url,target:"_blank"},domProps:{textContent:t._s(t.__("Edit"))}}):t._e()])}}],null,!0)})],1),e("data-list-pagination",{staticClass:"mt-6",attrs:{"resource-meta":t.paginationMeta,"per-page":t.perPage,"scroll-to-top":!1,"show-totals":!0},on:{"per-page-changed":t.selectPaginationPerPage,"page-selected":t.selectPaginationPage}})],1)}}],null,!1,3781765318)})],1)]):t._e()])},K=[],X=d(q,J,K,!1,null,null,null,null);const Q=X.exports;Statamic.$components.register("seo_pro-fieldtype",y);Statamic.$components.register("seo_pro_source-fieldtype",S);Statamic.$components.register("seo-pro-status-icon",c);Statamic.$components.register("seo-pro-report",Q);Statamic.$components.register("seo-pro-index-score",M);
